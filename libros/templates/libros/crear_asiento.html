<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Ingresar Nuevo Asiento</title>
</head>
<body>
    <h1>Ingresar Nuevo Asiento Contable</h1>
    <form method="post">
        {% csrf_token %}
        
        <h2>Datos del Asiento</h2>
        {{ form.as_p }}

        <hr>
        <h2>Movimientos Contables</h2>
        <table id="tablaMovimientos">
            <thead>
                <tr>
                    <th>Cuenta</th>
                    <th>Debe</th>
                    <th>Haber</th>
                    <th>Acción</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
        <button type="button" id="agregarFila">Agregar Movimiento</button>

        <hr>
        <button type="submit">Guardar Asiento Completo</button>
    </form>

    <script>
        // Script para agregar y eliminar filas de la tabla
        document.getElementById('agregarFila').addEventListener('click', function() {
            const tablaBody = document.querySelector('#tablaMovimientos tbody');
            const numFila = tablaBody.rows.length;
            const nuevaFila = tablaBody.insertRow();
            
            // Celda para la Cuenta (esto lo mejoraremos después para que sea un <select>)
            const celdaCuenta = nuevaFila.insertCell();
            celdaCuenta.innerHTML = `<input name="movimientos-${numFila}-cuenta" placeholder="Código de cuenta">`;

            // Celda para el Debe
            const celdaDebe = nuevaFila.insertCell();
            celdaDebe.innerHTML = `<input type="number" step="0.01" name="movimientos-${numFila}-debe" value="0">`;
            
            // Celda para el Haber
            const celdaHaber = nuevaFila.insertCell();
            celdaHaber.innerHTML = `<input type="number" step="0.01" name="movimientos-${numFila}-haber" value="0">`;
            
            // Celda para el botón de eliminar
            const celdaAccion = nuevaFila.insertCell();
            celdaAccion.innerHTML = '<button type="button" onclick="eliminarFila(this)">Eliminar</button>';
        });

        function eliminarFila(boton) {
            const fila = boton.parentNode.parentNode;
            fila.parentNode.removeChild(fila);
        }
    </script>
</body>
</html>